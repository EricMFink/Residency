%%% emf_generic.tex
%%% Pandoc template 
%%% Created by Eric M. Fink (https://github.com/EricMFink)

% ====================
% = Layout & Spacing =
% ====================

$if(fontsize)$
\documentclass[$fontsize$,letterpaper,twoside]{article}
$else$
\documentclass[12pt,letterpaper,twoside]{article}
$endif$

$if(geometry)$
\usepackage[$geometry$]{geometry}
$else$
\usepackage[hmarginratio=1:1,top=1in,bottom=1in,left=1.5in,right=1.5in]{geometry}
$endif$

\usepackage{setspace}
\usepackage{ragged2e}
\RaggedRight
\usepackage[none]{hyphenat}
$if(parindent)$
\setlength{\parindent}{$parindent$}
\setlength{\parskip}{0.5em}
$else$
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}
$endif$
\raggedbottom
\setlength{\emergencystretch}{3em}
\usepackage{multicol}

% ===================
% = Language & Date =
% ===================

\usepackage[english]{babel}
\usepackage{datetime}
\newdateformat{mydate}{\THEDAY-\monthname-\THEYEAR}

% ==================
% = Colors & Fonts =
% ==================

\usepackage[table]{xcolor}
\definecolor{OffBlack}{HTML}{191919}
\definecolor{Maroon}{HTML}{800000}
\definecolor{TarHeelBlue}{HTML}{4b9cd3}
\definecolor{HopkinsBlue}{HTML}{002D72}
\definecolor{RacingGreen}{HTML}{004225}

\usepackage{fontspec}
\setmainfont{Athelas}[Mapping={tex-text}]
\setsansfont{Adelle Sans}[Mapping=tex-text]
\setmonofont{LFT Etica Mono}[Mapping=tex-text,Scale=0.8]

\usepackage{textcomp}
\usepackage{amssymb}
\usepackage[]{ccicons}
\usepackage{fontawesome5}

% =======================
% = Headers and Footers =
% =======================

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyfoot[C]{}
\fancyfoot[R]{\tiny\texttt{Revised: \mydate\today}}
\fancyfoot[L]{}
$if(subtitle)$
\fancyhead[CE]{\small{$title$}}
\fancyhead[CO]{\small{$subtitle$}}
\fancyhead[LE]{\small{\thepage}}
\fancyhead[LO]{\small{}}
\fancyhead[RE]{\small{}}
\fancyhead[RO]{\small{\thepage}}
$else$
\fancyhead[C]{\small{$title$}}
\fancyhead[LE]{\small{\thepage}}
\fancyhead[LO]{\small{}}
\fancyhead[RE]{\small{}}
\fancyhead[RO]{\small{\thepage}}
$endif$

% ============
% = Headings =
% ============

\usepackage[compact]{titlesec}
% \titlespacing*{<command>}{<left>}{<before-sep>}{<after-sep>}
\titlespacing*{\section}{0em}{1.5em}{.5em}
\titlespacing*{\subsection}{0em}{1em}{.2em}
\titlespacing*{\subsubsection}{0em}{0em}{0em}
\titlespacing*{\paragraph}{0em}{0em}{0em}
\titlespacing*{\subparagraph}{0em}{0em}{0em}

$if(secnumdepth)$
\setcounter{secnumdepth}{$secnumdepth$}
$else$
\setcounter{secnumdepth}{0}
$endif$

\titleformat{\section}[hang]
  {\Large\sffamily\color{Maroon}}
  {\thesection}
  {1em}
  {}
\titleformat{\subsection}[hang]
  {\large\sffamily\color{Maroon}}
  {\thesubsection}
  {1em}
  {}
\titleformat{\subsubsection}[hang]
  {\normalsize\bfseries\sffamily}
  {\thesubsubsection}
  {1em}
  {}
\titleformat{\paragraph}[hang]
  {\normalsize\bfseries\rmfamily}
  {\theparagraph}
  {1em}
  {}
\titleformat{\subparagraph}[hang]
  {\normalsize\itshape\rmfamily}
  {\thesubparagraph}
  {1em}
  {}

% =========
% = Lists =
% =========

\usepackage{enumitem}
\setlistdepth{6}

\setlist[itemize]{label=\textbullet}

\setlist[1]{labelindent=.5em}
\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{labelsep=*, leftmargin=2em}
\setlist{nosep}
\providecommand{\tightlist}{%
  \setlength{\topsep}{0em}\setlength{\partopsep}{0em}\setlength{\itemsep}{0em}\setlength{\parskip}{0em}}

% ==========
% = Quotes =
% ==========

\usepackage{csquotes}
$if(fancyquote)$
\AtBeginEnvironment{quote}{\sffamily\small}
\renewenvironment{quote}{%
   \list{}{%
     \leftmargin2em   % this is the adjusting screw
     \rightmargin\leftmargin\parsep 0mm }
   \item\relax
}
{\endlist}
$else$
\AtBeginEnvironment{quote}{\small}
\renewenvironment{quote}{%
   \list{}{%
     \leftmargin2em   % this is the adjusting screw
     \rightmargin\leftmargin\parsep 0mm }
   \item\relax
}
{\endlist}
$endif$

% ==========
% = Tables =
% ==========

\usepackage{longtable}
\usepackage{supertabular,booktabs}

% ==============
% = Separators =
% ==============

\newcommand{\halfsep}{%
    \textcolor{Maroon}{\noindent\hfil\rule{.5\textwidth}{.5pt}\hfil} 
}

\newcommand*{\fullsep}{%
  \par
  \begingroup
    \centering
    \raisebox{.2\baselineskip}{%
      \textcolor{Maroon}{\rule{\linewidth}{2pt}}%
    }%
    \par
  \endgroup
}

% ==============
% = Blank Page =
% ==============

\usepackage{afterpage}
\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-2}%
    \newpage}

% ================
% = Title Layout =
% ================

\usepackage{titling}

% \setlength{\droptitle}{-3cm}
\title{$for(title)$\Large\textbf{$title$}$if(subtitle)$:\\ \textbf{$subtitle$} $endif$ $endfor$}
\author{$for(author)${$author$}$if(thanks)$ \thanks{$thanks$} $endif$ \\ $if(position)$ {$position$}\\$endif$ {$affiliation$}\\ $if(address)$ {$address$}$endif$ $endfor$}
\date{$date$}

% Aligns * for "thanks" footnote with left margin
\setlength\thanksmarkwidth{.5em}
\setlength\thanksmargin{-\thanksmarkwidth}

% ============
% = Graphics =
% ============

\usepackage[justification=centering,font={scriptsize},skip=1em]{caption}
% Sizes: scriptsize, footnotesize, small, normalsize, large, Large
\captionsetup[figure]{labelformat=empty,width=.8\linewidth}
\usepackage{float}
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
    \expandafter\origfigure\expandafter[H]
} {
    \endorigfigure
}

\usepackage[export]{adjustbox}% http://ctan.org/pkg/adjustbox
\let\oldincludegraphics\includegraphics
\renewcommand{\includegraphics}[2][]{%
  \oldincludegraphics[#1,max width=.75\linewidth]{#2}}

% =============
% = Footnotes =
% =============

\usepackage[hang,flushmargin]{footmisc}

% $if(notesymbols)$\renewcommand{\thefootnote}{\fnsymbol{footnote}}$endif$

% ==============
% = Hyperlinks =
% ==============

\usepackage{hyperref}
\hypersetup{%
  colorlinks=true,
  linkcolor=HopkinsBlue,
  citecolor=HopkinsBlue,
  urlcolor=Maroon,
  pdftitle={{$title$}$if(subtitle)$: {$subtitle$}$endif$},
  pdfauthor={$author-name$},
  pdfkeywords={$keywords$}
  pdfproducer={XeLateX with hyperref},
  pdfcreator={Xelatex}]{hyperref}
}
\urlstyle{sf}

% ==============================================================================
% =============================== BEGIN DOCUMENT ===============================
% ==============================================================================

\begin{document}

\singlespacing

$if(full-title)$
\maketitle

$else$

\thispagestyle{empty}
\begin{flushleft}

$if(subject)$
\sffamily{$subject$} \\
$endif$

$if(author)$
\sffamily{$author$} \\
$endif$

$if(affiliation)$
\sffamily{$affiliation$}  \\
$endif$

$if(date)$
\sffamily{$date$} \\
$endif$

$if(title)$
\vspace{5mm}
\section{$title$} \\
$endif$

$if(subtitle)$
\vspace{.5cm}
\subsection{$subtitle$} 
$endif$

\end{flushleft}

$endif$

$if(columns)$
\setlength{\columnsep}{3em}
\begin{multicols*}{2}
$body$
\end{multicols*}

$else$
$body$
$endif$

\end{document}
